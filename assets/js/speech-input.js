!function () { "use strict"; if ("webkitSpeechRecognition" in window) { var e = document.getElementsByClassName("speech-input");[].forEach.call(e, function (e) { var t, n, a, s, i = parseInt(e.dataset.patience, 10) || 6, l = e.nextSibling, o = e.parentNode, r = parseInt(getComputedStyle(e).borderRightWidth, 10), c = .8 * (e.dataset.buttonsize || e.offsetHeight); !e.dataset.buttonsize && "TEXTAREA" === e.tagName && c > 26 && (c = 26); var d = e.parentNode; d.classList.contains("si-wrapper") || ((d = document.createElement("div")).classList.add("si-wrapper"), d.appendChild(o.removeChild(e)), s = !0), (t = d.querySelector(".si-btn")) || ((t = document.createElement("button")).type = "button", t.classList.add("si-btn"), t.textContent = "speech input", n = document.createElement("span"), a = document.createElement("span"), n.classList.add("si-mic"), a.classList.add("si-holder"), t.appendChild(n), t.appendChild(a), d.appendChild(t), t.style.cursor = "pointer", t.style.top = "6px", t.style.height = t.style.width = "22px", e.style.paddingRight = c - r + "px"), s && o.insertBefore(d, l); var p, u, h = "", m = !1, f = null, v = new webkitSpeechRecognition; function g() { u = setTimeout(function () { v.stop() }, 1e3 * i) } v.continuous = !0, v.interimResults = !0, e.lang && (v.lang = e.lang), v.onstart = function () { f = e.placeholder, e.placeholder = e.dataset.ready || "Speak now", m = !0, t.classList.add("listening"), g() }, v.onend = function () { m = !1, clearTimeout(u), t.classList.remove("listening"), search_input(), null !== f && (e.placeholder = f), void 0 !== e.dataset.instantSubmit && e.value && e.form && e.form.submit() }, v.onresult = function (t) { clearTimeout(u); for (var n = t.results, a = "", s = "", i = t.resultIndex; i < n.length; ++i) { var l = n[i], o = l[0]; l.isFinal ? a = o.transcript : s += o.transcript } var r, c = a || s; c = !h || p ? (r = c).charAt(0).toUpperCase() + r.slice(1) : c, e.value = h + c, e.focus(), "INPUT" === e.tagName ? e.scrollLeft = e.scrollWidth : e.scrollTop = e.scrollHeight, g() }, t.addEventListener("click", function (t) { if (t.preventDefault(), m) v.stop(); else { var n = e.value.slice(-1).match(/\s/); h = !e.value || n ? e.value : e.value + " ", p = h.trim().slice(-1).match(/[\.\?\!]/), v.start() } }, !1) }) } }();